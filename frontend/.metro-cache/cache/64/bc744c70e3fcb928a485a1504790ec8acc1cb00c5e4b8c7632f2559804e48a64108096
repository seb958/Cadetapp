{"dependencies":[{"name":"../interfaces","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":18,"index":124},"end":{"line":7,"column":42,"index":148}}],"key":"596k1m46J08d+Af0Max0usWU1VI=","exportNames":["*"],"imports":1}},{"name":"./EventManager","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":43,"index":193},"end":{"line":8,"column":68,"index":218}}],"key":"MV7P0qSLfUx3BNx3HVTE8QBpThU=","exportNames":["*"],"imports":1}},{"name":"../../PointerType","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":19,"index":240},"end":{"line":9,"column":47,"index":268}}],"key":"GAwFf6ECEOo66Cd6tbX5TiUkJ2k=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _interfaces = require(_dependencyMap[0], \"../interfaces\");\n  var _EventManager = _interopRequireDefault(require(_dependencyMap[1], \"./EventManager\"));\n  var _PointerType = require(_dependencyMap[2], \"../../PointerType\");\n  function _interopRequireDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  class KeyboardEventManager extends _EventManager.default {\n    static activationKeys = ['Enter', ' '];\n    static cancelationKeys = ['Tab'];\n    isPressed = false;\n    static registeredStaticListeners = false;\n    static instances = new Set();\n    static keyUpStaticCallback = event => {\n      // We need a global listener, as in some cases, keyUp event gets stop-propagated.\n      // Then, if we used only component-level listeners the gesture would never end,\n      // causing other gestues to fail.\n\n      if (this.activationKeys.indexOf(event.key) === -1) {\n        return;\n      }\n      this.instances.forEach(item => {\n        item.onKeyUp(event);\n      });\n    };\n    keyDownCallback = event => {\n      if (KeyboardEventManager.cancelationKeys.indexOf(event.key) !== -1 && this.isPressed) {\n        this.dispatchEvent(event, _interfaces.EventTypes.CANCEL);\n        return;\n      }\n      if (KeyboardEventManager.activationKeys.indexOf(event.key) === -1) {\n        return;\n      }\n      this.dispatchEvent(event, _interfaces.EventTypes.DOWN);\n    };\n    onKeyUp = event => {\n      if (KeyboardEventManager.activationKeys.indexOf(event.key) === -1 || !this.isPressed) {\n        return;\n      }\n      this.dispatchEvent(event, _interfaces.EventTypes.UP);\n    };\n    dispatchEvent(event, eventType) {\n      if (!(event.target instanceof HTMLElement)) {\n        return;\n      }\n      const adaptedEvent = this.mapEvent(event, eventType);\n      switch (eventType) {\n        case _interfaces.EventTypes.UP:\n          this.isPressed = false;\n          this.onPointerUp(adaptedEvent);\n          break;\n        case _interfaces.EventTypes.DOWN:\n          this.isPressed = true;\n          this.onPointerDown(adaptedEvent);\n          break;\n        case _interfaces.EventTypes.CANCEL:\n          this.isPressed = false;\n          this.onPointerCancel(adaptedEvent);\n          break;\n      }\n    }\n    registerListeners() {\n      this.view.addEventListener('keydown', this.keyDownCallback);\n      KeyboardEventManager.instances.add(this);\n      if (!KeyboardEventManager.registeredStaticListeners) {\n        KeyboardEventManager.registeredStaticListeners = true;\n        document.addEventListener('keyup', KeyboardEventManager.keyUpStaticCallback, {\n          capture: true\n        });\n      }\n    }\n    unregisterListeners() {\n      this.view.removeEventListener('keydown', this.keyDownCallback);\n      KeyboardEventManager.instances.delete(this);\n      if (KeyboardEventManager.instances.size === 0) {\n        document.removeEventListener('keyup', KeyboardEventManager.keyUpStaticCallback, {\n          capture: true\n        });\n        KeyboardEventManager.registeredStaticListeners = false;\n      }\n    }\n    mapEvent(event, eventType) {\n      const viewRect = event.target.getBoundingClientRect();\n      const viewportPosition = {\n        x: viewRect?.x + viewRect?.width / 2,\n        y: viewRect?.y + viewRect?.height / 2\n      };\n      const relativePosition = {\n        x: viewRect?.width / 2,\n        y: viewRect?.height / 2\n      };\n      return {\n        x: viewportPosition.x,\n        y: viewportPosition.y,\n        offsetX: relativePosition.x,\n        offsetY: relativePosition.y,\n        pointerId: 0,\n        eventType: eventType,\n        pointerType: _PointerType.PointerType.KEY,\n        time: event.timeStamp\n      };\n    }\n  }\n  exports.default = KeyboardEventManager;\n});","lineCount":113,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,2,5,0],[6,3,5,1],[6,4,5,2],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"default"],[7,17,6,15],[7,20,6,18],[7,25,6,23],[7,26,6,24],[8,2,7,0],[8,6,7,4,"_interfaces"],[8,17,7,15],[8,20,7,18,"require"],[8,27,7,25],[8,28,7,25,"_dependencyMap"],[8,42,7,25],[8,62,7,41],[8,63,7,42],[9,2,8,0],[9,6,8,4,"_EventManager"],[9,19,8,17],[9,22,8,20,"_interopRequireDefault"],[9,44,8,42],[9,45,8,43,"require"],[9,52,8,50],[9,53,8,50,"_dependencyMap"],[9,67,8,50],[9,88,8,67],[9,89,8,68],[9,90,8,69],[10,2,9,0],[10,6,9,4,"_PointerType"],[10,18,9,16],[10,21,9,19,"require"],[10,28,9,26],[10,29,9,26,"_dependencyMap"],[10,43,9,26],[10,67,9,46],[10,68,9,47],[11,2,10,0],[11,11,10,9,"_interopRequireDefault"],[11,33,10,31,"_interopRequireDefault"],[11,34,10,32,"e"],[11,35,10,33],[11,37,10,35],[12,4,10,37],[12,11,10,44,"e"],[12,12,10,45],[12,16,10,49,"e"],[12,17,10,50],[12,18,10,51,"__esModule"],[12,28,10,61],[12,31,10,64,"e"],[12,32,10,65],[12,35,10,68],[13,6,10,70,"default"],[13,13,10,77],[13,15,10,79,"e"],[14,4,10,81],[14,5,10,82],[15,2,10,84],[16,2,11,0],[16,8,11,6,"KeyboardEventManager"],[16,28,11,26],[16,37,11,35,"_EventManager"],[16,50,11,48],[16,51,11,49,"default"],[16,58,11,56],[16,59,11,57],[17,4,12,2],[17,11,12,9,"activationKeys"],[17,25,12,23],[17,28,12,26],[17,29,12,27],[17,36,12,34],[17,38,12,36],[17,41,12,39],[17,42,12,40],[18,4,13,2],[18,11,13,9,"cancelationKeys"],[18,26,13,24],[18,29,13,27],[18,30,13,28],[18,35,13,33],[18,36,13,34],[19,4,14,2,"isPressed"],[19,13,14,11],[19,16,14,14],[19,21,14,19],[20,4,15,2],[20,11,15,9,"registeredStaticListeners"],[20,36,15,34],[20,39,15,37],[20,44,15,42],[21,4,16,2],[21,11,16,9,"instances"],[21,20,16,18],[21,23,16,21],[21,27,16,25,"Set"],[21,30,16,28],[21,31,16,29],[21,32,16,30],[22,4,17,2],[22,11,17,9,"keyUpStaticCallback"],[22,30,17,28],[22,33,17,31,"event"],[22,38,17,36],[22,42,17,40],[23,6,18,4],[24,6,19,4],[25,6,20,4],[27,6,22,4],[27,10,22,8],[27,14,22,12],[27,15,22,13,"activationKeys"],[27,29,22,27],[27,30,22,28,"indexOf"],[27,37,22,35],[27,38,22,36,"event"],[27,43,22,41],[27,44,22,42,"key"],[27,47,22,45],[27,48,22,46],[27,53,22,51],[27,54,22,52],[27,55,22,53],[27,57,22,55],[28,8,23,6],[29,6,24,4],[30,6,25,4],[30,10,25,8],[30,11,25,9,"instances"],[30,20,25,18],[30,21,25,19,"forEach"],[30,28,25,26],[30,29,25,27,"item"],[30,33,25,31],[30,37,25,35],[31,8,26,6,"item"],[31,12,26,10],[31,13,26,11,"onKeyUp"],[31,20,26,18],[31,21,26,19,"event"],[31,26,26,24],[31,27,26,25],[32,6,27,4],[32,7,27,5],[32,8,27,6],[33,4,28,2],[33,5,28,3],[34,4,29,2,"keyDownCallback"],[34,19,29,17],[34,22,29,20,"event"],[34,27,29,25],[34,31,29,29],[35,6,30,4],[35,10,30,8,"KeyboardEventManager"],[35,30,30,28],[35,31,30,29,"cancelationKeys"],[35,46,30,44],[35,47,30,45,"indexOf"],[35,54,30,52],[35,55,30,53,"event"],[35,60,30,58],[35,61,30,59,"key"],[35,64,30,62],[35,65,30,63],[35,70,30,68],[35,71,30,69],[35,72,30,70],[35,76,30,74],[35,80,30,78],[35,81,30,79,"isPressed"],[35,90,30,88],[35,92,30,90],[36,8,31,6],[36,12,31,10],[36,13,31,11,"dispatchEvent"],[36,26,31,24],[36,27,31,25,"event"],[36,32,31,30],[36,34,31,32,"_interfaces"],[36,45,31,43],[36,46,31,44,"EventTypes"],[36,56,31,54],[36,57,31,55,"CANCEL"],[36,63,31,61],[36,64,31,62],[37,8,32,6],[38,6,33,4],[39,6,34,4],[39,10,34,8,"KeyboardEventManager"],[39,30,34,28],[39,31,34,29,"activationKeys"],[39,45,34,43],[39,46,34,44,"indexOf"],[39,53,34,51],[39,54,34,52,"event"],[39,59,34,57],[39,60,34,58,"key"],[39,63,34,61],[39,64,34,62],[39,69,34,67],[39,70,34,68],[39,71,34,69],[39,73,34,71],[40,8,35,6],[41,6,36,4],[42,6,37,4],[42,10,37,8],[42,11,37,9,"dispatchEvent"],[42,24,37,22],[42,25,37,23,"event"],[42,30,37,28],[42,32,37,30,"_interfaces"],[42,43,37,41],[42,44,37,42,"EventTypes"],[42,54,37,52],[42,55,37,53,"DOWN"],[42,59,37,57],[42,60,37,58],[43,4,38,2],[43,5,38,3],[44,4,39,2,"onKeyUp"],[44,11,39,9],[44,14,39,12,"event"],[44,19,39,17],[44,23,39,21],[45,6,40,4],[45,10,40,8,"KeyboardEventManager"],[45,30,40,28],[45,31,40,29,"activationKeys"],[45,45,40,43],[45,46,40,44,"indexOf"],[45,53,40,51],[45,54,40,52,"event"],[45,59,40,57],[45,60,40,58,"key"],[45,63,40,61],[45,64,40,62],[45,69,40,67],[45,70,40,68],[45,71,40,69],[45,75,40,73],[45,76,40,74],[45,80,40,78],[45,81,40,79,"isPressed"],[45,90,40,88],[45,92,40,90],[46,8,41,6],[47,6,42,4],[48,6,43,4],[48,10,43,8],[48,11,43,9,"dispatchEvent"],[48,24,43,22],[48,25,43,23,"event"],[48,30,43,28],[48,32,43,30,"_interfaces"],[48,43,43,41],[48,44,43,42,"EventTypes"],[48,54,43,52],[48,55,43,53,"UP"],[48,57,43,55],[48,58,43,56],[49,4,44,2],[49,5,44,3],[50,4,45,2,"dispatchEvent"],[50,17,45,15,"dispatchEvent"],[50,18,45,16,"event"],[50,23,45,21],[50,25,45,23,"eventType"],[50,34,45,32],[50,36,45,34],[51,6,46,4],[51,10,46,8],[51,12,46,10,"event"],[51,17,46,15],[51,18,46,16,"target"],[51,24,46,22],[51,36,46,34,"HTMLElement"],[51,47,46,45],[51,48,46,46],[51,50,46,48],[52,8,47,6],[53,6,48,4],[54,6,49,4],[54,12,49,10,"adaptedEvent"],[54,24,49,22],[54,27,49,25],[54,31,49,29],[54,32,49,30,"mapEvent"],[54,40,49,38],[54,41,49,39,"event"],[54,46,49,44],[54,48,49,46,"eventType"],[54,57,49,55],[54,58,49,56],[55,6,50,4],[55,14,50,12,"eventType"],[55,23,50,21],[56,8,51,6],[56,13,51,11,"_interfaces"],[56,24,51,22],[56,25,51,23,"EventTypes"],[56,35,51,33],[56,36,51,34,"UP"],[56,38,51,36],[57,10,52,8],[57,14,52,12],[57,15,52,13,"isPressed"],[57,24,52,22],[57,27,52,25],[57,32,52,30],[58,10,53,8],[58,14,53,12],[58,15,53,13,"onPointerUp"],[58,26,53,24],[58,27,53,25,"adaptedEvent"],[58,39,53,37],[58,40,53,38],[59,10,54,8],[60,8,55,6],[60,13,55,11,"_interfaces"],[60,24,55,22],[60,25,55,23,"EventTypes"],[60,35,55,33],[60,36,55,34,"DOWN"],[60,40,55,38],[61,10,56,8],[61,14,56,12],[61,15,56,13,"isPressed"],[61,24,56,22],[61,27,56,25],[61,31,56,29],[62,10,57,8],[62,14,57,12],[62,15,57,13,"onPointerDown"],[62,28,57,26],[62,29,57,27,"adaptedEvent"],[62,41,57,39],[62,42,57,40],[63,10,58,8],[64,8,59,6],[64,13,59,11,"_interfaces"],[64,24,59,22],[64,25,59,23,"EventTypes"],[64,35,59,33],[64,36,59,34,"CANCEL"],[64,42,59,40],[65,10,60,8],[65,14,60,12],[65,15,60,13,"isPressed"],[65,24,60,22],[65,27,60,25],[65,32,60,30],[66,10,61,8],[66,14,61,12],[66,15,61,13,"onPointerCancel"],[66,30,61,28],[66,31,61,29,"adaptedEvent"],[66,43,61,41],[66,44,61,42],[67,10,62,8],[68,6,63,4],[69,4,64,2],[70,4,65,2,"registerListeners"],[70,21,65,19,"registerListeners"],[70,22,65,19],[70,24,65,22],[71,6,66,4],[71,10,66,8],[71,11,66,9,"view"],[71,15,66,13],[71,16,66,14,"addEventListener"],[71,32,66,30],[71,33,66,31],[71,42,66,40],[71,44,66,42],[71,48,66,46],[71,49,66,47,"keyDownCallback"],[71,64,66,62],[71,65,66,63],[72,6,67,4,"KeyboardEventManager"],[72,26,67,24],[72,27,67,25,"instances"],[72,36,67,34],[72,37,67,35,"add"],[72,40,67,38],[72,41,67,39],[72,45,67,43],[72,46,67,44],[73,6,68,4],[73,10,68,8],[73,11,68,9,"KeyboardEventManager"],[73,31,68,29],[73,32,68,30,"registeredStaticListeners"],[73,57,68,55],[73,59,68,57],[74,8,69,6,"KeyboardEventManager"],[74,28,69,26],[74,29,69,27,"registeredStaticListeners"],[74,54,69,52],[74,57,69,55],[74,61,69,59],[75,8,70,6,"document"],[75,16,70,14],[75,17,70,15,"addEventListener"],[75,33,70,31],[75,34,70,32],[75,41,70,39],[75,43,70,41,"KeyboardEventManager"],[75,63,70,61],[75,64,70,62,"keyUpStaticCallback"],[75,83,70,81],[75,85,70,83],[76,10,71,8,"capture"],[76,17,71,15],[76,19,71,17],[77,8,72,6],[77,9,72,7],[77,10,72,8],[78,6,73,4],[79,4,74,2],[80,4,75,2,"unregisterListeners"],[80,23,75,21,"unregisterListeners"],[80,24,75,21],[80,26,75,24],[81,6,76,4],[81,10,76,8],[81,11,76,9,"view"],[81,15,76,13],[81,16,76,14,"removeEventListener"],[81,35,76,33],[81,36,76,34],[81,45,76,43],[81,47,76,45],[81,51,76,49],[81,52,76,50,"keyDownCallback"],[81,67,76,65],[81,68,76,66],[82,6,77,4,"KeyboardEventManager"],[82,26,77,24],[82,27,77,25,"instances"],[82,36,77,34],[82,37,77,35,"delete"],[82,43,77,41],[82,44,77,42],[82,48,77,46],[82,49,77,47],[83,6,78,4],[83,10,78,8,"KeyboardEventManager"],[83,30,78,28],[83,31,78,29,"instances"],[83,40,78,38],[83,41,78,39,"size"],[83,45,78,43],[83,50,78,48],[83,51,78,49],[83,53,78,51],[84,8,79,6,"document"],[84,16,79,14],[84,17,79,15,"removeEventListener"],[84,36,79,34],[84,37,79,35],[84,44,79,42],[84,46,79,44,"KeyboardEventManager"],[84,66,79,64],[84,67,79,65,"keyUpStaticCallback"],[84,86,79,84],[84,88,79,86],[85,10,80,8,"capture"],[85,17,80,15],[85,19,80,17],[86,8,81,6],[86,9,81,7],[86,10,81,8],[87,8,82,6,"KeyboardEventManager"],[87,28,82,26],[87,29,82,27,"registeredStaticListeners"],[87,54,82,52],[87,57,82,55],[87,62,82,60],[88,6,83,4],[89,4,84,2],[90,4,85,2,"mapEvent"],[90,12,85,10,"mapEvent"],[90,13,85,11,"event"],[90,18,85,16],[90,20,85,18,"eventType"],[90,29,85,27],[90,31,85,29],[91,6,86,4],[91,12,86,10,"viewRect"],[91,20,86,18],[91,23,86,21,"event"],[91,28,86,26],[91,29,86,27,"target"],[91,35,86,33],[91,36,86,34,"getBoundingClientRect"],[91,57,86,55],[91,58,86,56],[91,59,86,57],[92,6,87,4],[92,12,87,10,"viewportPosition"],[92,28,87,26],[92,31,87,29],[93,8,88,6,"x"],[93,9,88,7],[93,11,88,9,"viewRect"],[93,19,88,17],[93,21,88,19,"x"],[93,22,88,20],[93,25,88,23,"viewRect"],[93,33,88,31],[93,35,88,33,"width"],[93,40,88,38],[93,43,88,41],[93,44,88,42],[94,8,89,6,"y"],[94,9,89,7],[94,11,89,9,"viewRect"],[94,19,89,17],[94,21,89,19,"y"],[94,22,89,20],[94,25,89,23,"viewRect"],[94,33,89,31],[94,35,89,33,"height"],[94,41,89,39],[94,44,89,42],[95,6,90,4],[95,7,90,5],[96,6,91,4],[96,12,91,10,"relativePosition"],[96,28,91,26],[96,31,91,29],[97,8,92,6,"x"],[97,9,92,7],[97,11,92,9,"viewRect"],[97,19,92,17],[97,21,92,19,"width"],[97,26,92,24],[97,29,92,27],[97,30,92,28],[98,8,93,6,"y"],[98,9,93,7],[98,11,93,9,"viewRect"],[98,19,93,17],[98,21,93,19,"height"],[98,27,93,25],[98,30,93,28],[99,6,94,4],[99,7,94,5],[100,6,95,4],[100,13,95,11],[101,8,96,6,"x"],[101,9,96,7],[101,11,96,9,"viewportPosition"],[101,27,96,25],[101,28,96,26,"x"],[101,29,96,27],[102,8,97,6,"y"],[102,9,97,7],[102,11,97,9,"viewportPosition"],[102,27,97,25],[102,28,97,26,"y"],[102,29,97,27],[103,8,98,6,"offsetX"],[103,15,98,13],[103,17,98,15,"relativePosition"],[103,33,98,31],[103,34,98,32,"x"],[103,35,98,33],[104,8,99,6,"offsetY"],[104,15,99,13],[104,17,99,15,"relativePosition"],[104,33,99,31],[104,34,99,32,"y"],[104,35,99,33],[105,8,100,6,"pointerId"],[105,17,100,15],[105,19,100,17],[105,20,100,18],[106,8,101,6,"eventType"],[106,17,101,15],[106,19,101,17,"eventType"],[106,28,101,26],[107,8,102,6,"pointerType"],[107,19,102,17],[107,21,102,19,"_PointerType"],[107,33,102,31],[107,34,102,32,"PointerType"],[107,45,102,43],[107,46,102,44,"KEY"],[107,49,102,47],[108,8,103,6,"time"],[108,12,103,10],[108,14,103,12,"event"],[108,19,103,17],[108,20,103,18,"timeStamp"],[109,6,104,4],[109,7,104,5],[110,4,105,2],[111,2,106,0],[112,2,107,0,"exports"],[112,9,107,7],[112,10,107,8,"default"],[112,17,107,15],[112,20,107,18,"KeyboardEventManager"],[112,40,107,38],[113,0,107,39],[113,3]],"functionMap":{"names":["<global>","_interopRequireDefault","KeyboardEventManager","keyUpStaticCallback","instances.forEach$argument_0","keyDownCallback","onKeyUp","dispatchEvent","registerListeners","unregisterListeners","mapEvent"],"mappings":"AAA;ACS,qFD;AEC;+BCM;2BCQ;KDE;GDC;oBGC;GHS;YIC;GJK;EKC;GLmB;EMC;GNS;EOC;GPS;EQC;GRoB;CFC"},"hasCjsExports":true},"type":"js/module"}]}