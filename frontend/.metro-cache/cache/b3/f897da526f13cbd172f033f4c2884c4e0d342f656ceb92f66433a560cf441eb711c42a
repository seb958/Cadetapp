{"dependencies":[{"name":"../interfaces","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}}],"key":"GMKh3a5g5xNaAog15vl07v6pG2U=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return RotationGestureDetector;\n    }\n  });\n  var _interfaces = require(_dependencyMap[0], \"../interfaces\");\n  class RotationGestureDetector {\n    currentTime = 0;\n    previousTime = 0;\n    previousAngle = 0;\n    _rotation = 0;\n    _anchorX = 0;\n    _anchorY = 0;\n    isInProgress = false;\n    keyPointers = [NaN, NaN];\n    constructor(callbacks) {\n      this.onRotationBegin = callbacks.onRotationBegin;\n      this.onRotation = callbacks.onRotation;\n      this.onRotationEnd = callbacks.onRotationEnd;\n    }\n    updateCurrent(event, tracker) {\n      this.previousTime = this.currentTime;\n      this.currentTime = event.time;\n      const [firstPointerID, secondPointerID] = this.keyPointers;\n      const firstPointerCoords = tracker.getLastAbsoluteCoords(firstPointerID);\n      const secondPointerCoords = tracker.getLastAbsoluteCoords(secondPointerID);\n      if (!firstPointerCoords || !secondPointerCoords) {\n        return;\n      }\n      const vectorX = secondPointerCoords.x - firstPointerCoords.x;\n      const vectorY = secondPointerCoords.y - firstPointerCoords.y;\n      this._anchorX = (firstPointerCoords.x + secondPointerCoords.x) / 2;\n      this._anchorY = (firstPointerCoords.y + secondPointerCoords.y) / 2;\n\n      // Angle diff should be positive when rotating in clockwise direction\n      const angle = -Math.atan2(vectorY, vectorX);\n      this._rotation = Number.isNaN(this.previousAngle) ? 0 : this.previousAngle - angle;\n      this.previousAngle = angle;\n      if (this.rotation > Math.PI) {\n        this._rotation -= Math.PI;\n      } else if (this.rotation < -Math.PI) {\n        this._rotation += Math.PI;\n      }\n      if (this.rotation > Math.PI / 2) {\n        this._rotation -= Math.PI;\n      } else if (this.rotation < -Math.PI / 2) {\n        this._rotation += Math.PI;\n      }\n    }\n    finish() {\n      if (!this.isInProgress) {\n        return;\n      }\n      this.isInProgress = false;\n      this.keyPointers = [NaN, NaN];\n      this.onRotationEnd(this);\n    }\n    setKeyPointers(tracker) {\n      if (this.keyPointers[0] && this.keyPointers[1]) {\n        return;\n      }\n      const pointerIDs = tracker.trackedPointers.keys();\n      this.keyPointers[0] = pointerIDs.next().value;\n      this.keyPointers[1] = pointerIDs.next().value;\n    }\n    onTouchEvent(event, tracker) {\n      switch (event.eventType) {\n        case _interfaces.EventTypes.DOWN:\n          this.isInProgress = false;\n          break;\n        case _interfaces.EventTypes.ADDITIONAL_POINTER_DOWN:\n          if (this.isInProgress) {\n            break;\n          }\n          this.isInProgress = true;\n          this.previousTime = event.time;\n          this.previousAngle = NaN;\n          this.setKeyPointers(tracker);\n          this.updateCurrent(event, tracker);\n          this.onRotationBegin(this);\n          break;\n        case _interfaces.EventTypes.MOVE:\n          if (!this.isInProgress) {\n            break;\n          }\n          this.updateCurrent(event, tracker);\n          this.onRotation(this);\n          break;\n        case _interfaces.EventTypes.ADDITIONAL_POINTER_UP:\n          if (!this.isInProgress) {\n            break;\n          }\n          if (this.keyPointers.indexOf(event.pointerId) >= 0) {\n            this.finish();\n          }\n          break;\n        case _interfaces.EventTypes.UP:\n          if (this.isInProgress) {\n            this.finish();\n          }\n          break;\n      }\n      return true;\n    }\n    reset() {\n      this.keyPointers = [NaN, NaN];\n      this.isInProgress = false;\n    }\n    get anchorX() {\n      return this._anchorX;\n    }\n    get anchorY() {\n      return this._anchorY;\n    }\n    get rotation() {\n      return this._rotation;\n    }\n    get timeDelta() {\n      return this.currentTime + this.previousTime;\n    }\n  }\n});","lineCount":129,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,4,15,"Object"],[7,8,4,15],[7,9,4,15,"defineProperty"],[7,23,4,15],[7,24,4,15,"exports"],[7,31,4,15],[8,4,4,15,"enumerable"],[8,14,4,15],[9,4,4,15,"get"],[9,7,4,15],[9,18,4,15,"get"],[9,19,4,15],[10,6,4,15],[10,13,4,15,"RotationGestureDetector"],[10,36,4,15],[11,4,4,15],[12,2,4,15],[13,2,3,0],[13,6,3,0,"_interfaces"],[13,17,3,0],[13,20,3,0,"require"],[13,27,3,0],[13,28,3,0,"_dependencyMap"],[13,42,3,0],[14,2,4,15],[14,8,4,21,"RotationGestureDetector"],[14,31,4,44],[14,32,4,45],[15,4,5,2,"currentTime"],[15,15,5,13],[15,18,5,16],[15,19,5,17],[16,4,6,2,"previousTime"],[16,16,6,14],[16,19,6,17],[16,20,6,18],[17,4,7,2,"previousAngle"],[17,17,7,15],[17,20,7,18],[17,21,7,19],[18,4,8,2,"_rotation"],[18,13,8,11],[18,16,8,14],[18,17,8,15],[19,4,9,2,"_anchorX"],[19,12,9,10],[19,15,9,13],[19,16,9,14],[20,4,10,2,"_anchorY"],[20,12,10,10],[20,15,10,13],[20,16,10,14],[21,4,11,2,"isInProgress"],[21,16,11,14],[21,19,11,17],[21,24,11,22],[22,4,12,2,"keyPointers"],[22,15,12,13],[22,18,12,16],[22,19,12,17,"NaN"],[22,22,12,20],[22,24,12,22,"NaN"],[22,27,12,25],[22,28,12,26],[23,4,13,2,"constructor"],[23,15,13,13,"constructor"],[23,16,13,14,"callbacks"],[23,25,13,23],[23,27,13,25],[24,6,14,4],[24,10,14,8],[24,11,14,9,"onRotationBegin"],[24,26,14,24],[24,29,14,27,"callbacks"],[24,38,14,36],[24,39,14,37,"onRotationBegin"],[24,54,14,52],[25,6,15,4],[25,10,15,8],[25,11,15,9,"onRotation"],[25,21,15,19],[25,24,15,22,"callbacks"],[25,33,15,31],[25,34,15,32,"onRotation"],[25,44,15,42],[26,6,16,4],[26,10,16,8],[26,11,16,9,"onRotationEnd"],[26,24,16,22],[26,27,16,25,"callbacks"],[26,36,16,34],[26,37,16,35,"onRotationEnd"],[26,50,16,48],[27,4,17,2],[28,4,18,2,"updateCurrent"],[28,17,18,15,"updateCurrent"],[28,18,18,16,"event"],[28,23,18,21],[28,25,18,23,"tracker"],[28,32,18,30],[28,34,18,32],[29,6,19,4],[29,10,19,8],[29,11,19,9,"previousTime"],[29,23,19,21],[29,26,19,24],[29,30,19,28],[29,31,19,29,"currentTime"],[29,42,19,40],[30,6,20,4],[30,10,20,8],[30,11,20,9,"currentTime"],[30,22,20,20],[30,25,20,23,"event"],[30,30,20,28],[30,31,20,29,"time"],[30,35,20,33],[31,6,21,4],[31,12,21,10],[31,13,21,11,"firstPointerID"],[31,27,21,25],[31,29,21,27,"secondPointerID"],[31,44,21,42],[31,45,21,43],[31,48,21,46],[31,52,21,50],[31,53,21,51,"keyPointers"],[31,64,21,62],[32,6,22,4],[32,12,22,10,"firstPointerCoords"],[32,30,22,28],[32,33,22,31,"tracker"],[32,40,22,38],[32,41,22,39,"getLastAbsoluteCoords"],[32,62,22,60],[32,63,22,61,"firstPointerID"],[32,77,22,75],[32,78,22,76],[33,6,23,4],[33,12,23,10,"secondPointerCoords"],[33,31,23,29],[33,34,23,32,"tracker"],[33,41,23,39],[33,42,23,40,"getLastAbsoluteCoords"],[33,63,23,61],[33,64,23,62,"secondPointerID"],[33,79,23,77],[33,80,23,78],[34,6,24,4],[34,10,24,8],[34,11,24,9,"firstPointerCoords"],[34,29,24,27],[34,33,24,31],[34,34,24,32,"secondPointerCoords"],[34,53,24,51],[34,55,24,53],[35,8,25,6],[36,6,26,4],[37,6,27,4],[37,12,27,10,"vectorX"],[37,19,27,17],[37,22,27,20,"secondPointerCoords"],[37,41,27,39],[37,42,27,40,"x"],[37,43,27,41],[37,46,27,44,"firstPointerCoords"],[37,64,27,62],[37,65,27,63,"x"],[37,66,27,64],[38,6,28,4],[38,12,28,10,"vectorY"],[38,19,28,17],[38,22,28,20,"secondPointerCoords"],[38,41,28,39],[38,42,28,40,"y"],[38,43,28,41],[38,46,28,44,"firstPointerCoords"],[38,64,28,62],[38,65,28,63,"y"],[38,66,28,64],[39,6,29,4],[39,10,29,8],[39,11,29,9,"_anchorX"],[39,19,29,17],[39,22,29,20],[39,23,29,21,"firstPointerCoords"],[39,41,29,39],[39,42,29,40,"x"],[39,43,29,41],[39,46,29,44,"secondPointerCoords"],[39,65,29,63],[39,66,29,64,"x"],[39,67,29,65],[39,71,29,69],[39,72,29,70],[40,6,30,4],[40,10,30,8],[40,11,30,9,"_anchorY"],[40,19,30,17],[40,22,30,20],[40,23,30,21,"firstPointerCoords"],[40,41,30,39],[40,42,30,40,"y"],[40,43,30,41],[40,46,30,44,"secondPointerCoords"],[40,65,30,63],[40,66,30,64,"y"],[40,67,30,65],[40,71,30,69],[40,72,30,70],[42,6,32,4],[43,6,33,4],[43,12,33,10,"angle"],[43,17,33,15],[43,20,33,18],[43,21,33,19,"Math"],[43,25,33,23],[43,26,33,24,"atan2"],[43,31,33,29],[43,32,33,30,"vectorY"],[43,39,33,37],[43,41,33,39,"vectorX"],[43,48,33,46],[43,49,33,47],[44,6,34,4],[44,10,34,8],[44,11,34,9,"_rotation"],[44,20,34,18],[44,23,34,21,"Number"],[44,29,34,27],[44,30,34,28,"isNaN"],[44,35,34,33],[44,36,34,34],[44,40,34,38],[44,41,34,39,"previousAngle"],[44,54,34,52],[44,55,34,53],[44,58,34,56],[44,59,34,57],[44,62,34,60],[44,66,34,64],[44,67,34,65,"previousAngle"],[44,80,34,78],[44,83,34,81,"angle"],[44,88,34,86],[45,6,35,4],[45,10,35,8],[45,11,35,9,"previousAngle"],[45,24,35,22],[45,27,35,25,"angle"],[45,32,35,30],[46,6,36,4],[46,10,36,8],[46,14,36,12],[46,15,36,13,"rotation"],[46,23,36,21],[46,26,36,24,"Math"],[46,30,36,28],[46,31,36,29,"PI"],[46,33,36,31],[46,35,36,33],[47,8,37,6],[47,12,37,10],[47,13,37,11,"_rotation"],[47,22,37,20],[47,26,37,24,"Math"],[47,30,37,28],[47,31,37,29,"PI"],[47,33,37,31],[48,6,38,4],[48,7,38,5],[48,13,38,11],[48,17,38,15],[48,21,38,19],[48,22,38,20,"rotation"],[48,30,38,28],[48,33,38,31],[48,34,38,32,"Math"],[48,38,38,36],[48,39,38,37,"PI"],[48,41,38,39],[48,43,38,41],[49,8,39,6],[49,12,39,10],[49,13,39,11,"_rotation"],[49,22,39,20],[49,26,39,24,"Math"],[49,30,39,28],[49,31,39,29,"PI"],[49,33,39,31],[50,6,40,4],[51,6,41,4],[51,10,41,8],[51,14,41,12],[51,15,41,13,"rotation"],[51,23,41,21],[51,26,41,24,"Math"],[51,30,41,28],[51,31,41,29,"PI"],[51,33,41,31],[51,36,41,34],[51,37,41,35],[51,39,41,37],[52,8,42,6],[52,12,42,10],[52,13,42,11,"_rotation"],[52,22,42,20],[52,26,42,24,"Math"],[52,30,42,28],[52,31,42,29,"PI"],[52,33,42,31],[53,6,43,4],[53,7,43,5],[53,13,43,11],[53,17,43,15],[53,21,43,19],[53,22,43,20,"rotation"],[53,30,43,28],[53,33,43,31],[53,34,43,32,"Math"],[53,38,43,36],[53,39,43,37,"PI"],[53,41,43,39],[53,44,43,42],[53,45,43,43],[53,47,43,45],[54,8,44,6],[54,12,44,10],[54,13,44,11,"_rotation"],[54,22,44,20],[54,26,44,24,"Math"],[54,30,44,28],[54,31,44,29,"PI"],[54,33,44,31],[55,6,45,4],[56,4,46,2],[57,4,47,2,"finish"],[57,10,47,8,"finish"],[57,11,47,8],[57,13,47,11],[58,6,48,4],[58,10,48,8],[58,11,48,9],[58,15,48,13],[58,16,48,14,"isInProgress"],[58,28,48,26],[58,30,48,28],[59,8,49,6],[60,6,50,4],[61,6,51,4],[61,10,51,8],[61,11,51,9,"isInProgress"],[61,23,51,21],[61,26,51,24],[61,31,51,29],[62,6,52,4],[62,10,52,8],[62,11,52,9,"keyPointers"],[62,22,52,20],[62,25,52,23],[62,26,52,24,"NaN"],[62,29,52,27],[62,31,52,29,"NaN"],[62,34,52,32],[62,35,52,33],[63,6,53,4],[63,10,53,8],[63,11,53,9,"onRotationEnd"],[63,24,53,22],[63,25,53,23],[63,29,53,27],[63,30,53,28],[64,4,54,2],[65,4,55,2,"setKeyPointers"],[65,18,55,16,"setKeyPointers"],[65,19,55,17,"tracker"],[65,26,55,24],[65,28,55,26],[66,6,56,4],[66,10,56,8],[66,14,56,12],[66,15,56,13,"keyPointers"],[66,26,56,24],[66,27,56,25],[66,28,56,26],[66,29,56,27],[66,33,56,31],[66,37,56,35],[66,38,56,36,"keyPointers"],[66,49,56,47],[66,50,56,48],[66,51,56,49],[66,52,56,50],[66,54,56,52],[67,8,57,6],[68,6,58,4],[69,6,59,4],[69,12,59,10,"pointerIDs"],[69,22,59,20],[69,25,59,23,"tracker"],[69,32,59,30],[69,33,59,31,"trackedPointers"],[69,48,59,46],[69,49,59,47,"keys"],[69,53,59,51],[69,54,59,52],[69,55,59,53],[70,6,60,4],[70,10,60,8],[70,11,60,9,"keyPointers"],[70,22,60,20],[70,23,60,21],[70,24,60,22],[70,25,60,23],[70,28,60,26,"pointerIDs"],[70,38,60,36],[70,39,60,37,"next"],[70,43,60,41],[70,44,60,42],[70,45,60,43],[70,46,60,44,"value"],[70,51,60,49],[71,6,61,4],[71,10,61,8],[71,11,61,9,"keyPointers"],[71,22,61,20],[71,23,61,21],[71,24,61,22],[71,25,61,23],[71,28,61,26,"pointerIDs"],[71,38,61,36],[71,39,61,37,"next"],[71,43,61,41],[71,44,61,42],[71,45,61,43],[71,46,61,44,"value"],[71,51,61,49],[72,4,62,2],[73,4,63,2,"onTouchEvent"],[73,16,63,14,"onTouchEvent"],[73,17,63,15,"event"],[73,22,63,20],[73,24,63,22,"tracker"],[73,31,63,29],[73,33,63,31],[74,6,64,4],[74,14,64,12,"event"],[74,19,64,17],[74,20,64,18,"eventType"],[74,29,64,27],[75,8,65,6],[75,13,65,11,"EventTypes"],[75,24,65,21],[75,25,65,21,"EventTypes"],[75,35,65,21],[75,36,65,22,"DOWN"],[75,40,65,26],[76,10,66,8],[76,14,66,12],[76,15,66,13,"isInProgress"],[76,27,66,25],[76,30,66,28],[76,35,66,33],[77,10,67,8],[78,8,68,6],[78,13,68,11,"EventTypes"],[78,24,68,21],[78,25,68,21,"EventTypes"],[78,35,68,21],[78,36,68,22,"ADDITIONAL_POINTER_DOWN"],[78,59,68,45],[79,10,69,8],[79,14,69,12],[79,18,69,16],[79,19,69,17,"isInProgress"],[79,31,69,29],[79,33,69,31],[80,12,70,10],[81,10,71,8],[82,10,72,8],[82,14,72,12],[82,15,72,13,"isInProgress"],[82,27,72,25],[82,30,72,28],[82,34,72,32],[83,10,73,8],[83,14,73,12],[83,15,73,13,"previousTime"],[83,27,73,25],[83,30,73,28,"event"],[83,35,73,33],[83,36,73,34,"time"],[83,40,73,38],[84,10,74,8],[84,14,74,12],[84,15,74,13,"previousAngle"],[84,28,74,26],[84,31,74,29,"NaN"],[84,34,74,32],[85,10,75,8],[85,14,75,12],[85,15,75,13,"setKeyPointers"],[85,29,75,27],[85,30,75,28,"tracker"],[85,37,75,35],[85,38,75,36],[86,10,76,8],[86,14,76,12],[86,15,76,13,"updateCurrent"],[86,28,76,26],[86,29,76,27,"event"],[86,34,76,32],[86,36,76,34,"tracker"],[86,43,76,41],[86,44,76,42],[87,10,77,8],[87,14,77,12],[87,15,77,13,"onRotationBegin"],[87,30,77,28],[87,31,77,29],[87,35,77,33],[87,36,77,34],[88,10,78,8],[89,8,79,6],[89,13,79,11,"EventTypes"],[89,24,79,21],[89,25,79,21,"EventTypes"],[89,35,79,21],[89,36,79,22,"MOVE"],[89,40,79,26],[90,10,80,8],[90,14,80,12],[90,15,80,13],[90,19,80,17],[90,20,80,18,"isInProgress"],[90,32,80,30],[90,34,80,32],[91,12,81,10],[92,10,82,8],[93,10,83,8],[93,14,83,12],[93,15,83,13,"updateCurrent"],[93,28,83,26],[93,29,83,27,"event"],[93,34,83,32],[93,36,83,34,"tracker"],[93,43,83,41],[93,44,83,42],[94,10,84,8],[94,14,84,12],[94,15,84,13,"onRotation"],[94,25,84,23],[94,26,84,24],[94,30,84,28],[94,31,84,29],[95,10,85,8],[96,8,86,6],[96,13,86,11,"EventTypes"],[96,24,86,21],[96,25,86,21,"EventTypes"],[96,35,86,21],[96,36,86,22,"ADDITIONAL_POINTER_UP"],[96,57,86,43],[97,10,87,8],[97,14,87,12],[97,15,87,13],[97,19,87,17],[97,20,87,18,"isInProgress"],[97,32,87,30],[97,34,87,32],[98,12,88,10],[99,10,89,8],[100,10,90,8],[100,14,90,12],[100,18,90,16],[100,19,90,17,"keyPointers"],[100,30,90,28],[100,31,90,29,"indexOf"],[100,38,90,36],[100,39,90,37,"event"],[100,44,90,42],[100,45,90,43,"pointerId"],[100,54,90,52],[100,55,90,53],[100,59,90,57],[100,60,90,58],[100,62,90,60],[101,12,91,10],[101,16,91,14],[101,17,91,15,"finish"],[101,23,91,21],[101,24,91,22],[101,25,91,23],[102,10,92,8],[103,10,93,8],[104,8,94,6],[104,13,94,11,"EventTypes"],[104,24,94,21],[104,25,94,21,"EventTypes"],[104,35,94,21],[104,36,94,22,"UP"],[104,38,94,24],[105,10,95,8],[105,14,95,12],[105,18,95,16],[105,19,95,17,"isInProgress"],[105,31,95,29],[105,33,95,31],[106,12,96,10],[106,16,96,14],[106,17,96,15,"finish"],[106,23,96,21],[106,24,96,22],[106,25,96,23],[107,10,97,8],[108,10,98,8],[109,6,99,4],[110,6,100,4],[110,13,100,11],[110,17,100,15],[111,4,101,2],[112,4,102,2,"reset"],[112,9,102,7,"reset"],[112,10,102,7],[112,12,102,10],[113,6,103,4],[113,10,103,8],[113,11,103,9,"keyPointers"],[113,22,103,20],[113,25,103,23],[113,26,103,24,"NaN"],[113,29,103,27],[113,31,103,29,"NaN"],[113,34,103,32],[113,35,103,33],[114,6,104,4],[114,10,104,8],[114,11,104,9,"isInProgress"],[114,23,104,21],[114,26,104,24],[114,31,104,29],[115,4,105,2],[116,4,106,2],[116,8,106,6,"anchorX"],[116,15,106,13,"anchorX"],[116,16,106,13],[116,18,106,16],[117,6,107,4],[117,13,107,11],[117,17,107,15],[117,18,107,16,"_anchorX"],[117,26,107,24],[118,4,108,2],[119,4,109,2],[119,8,109,6,"anchorY"],[119,15,109,13,"anchorY"],[119,16,109,13],[119,18,109,16],[120,6,110,4],[120,13,110,11],[120,17,110,15],[120,18,110,16,"_anchorY"],[120,26,110,24],[121,4,111,2],[122,4,112,2],[122,8,112,6,"rotation"],[122,16,112,14,"rotation"],[122,17,112,14],[122,19,112,17],[123,6,113,4],[123,13,113,11],[123,17,113,15],[123,18,113,16,"_rotation"],[123,27,113,25],[124,4,114,2],[125,4,115,2],[125,8,115,6,"timeDelta"],[125,17,115,15,"timeDelta"],[125,18,115,15],[125,20,115,18],[126,6,116,4],[126,13,116,11],[126,17,116,15],[126,18,116,16,"currentTime"],[126,29,116,27],[126,32,116,30],[126,36,116,34],[126,37,116,35,"previousTime"],[126,49,116,47],[127,4,117,2],[128,2,118,0],[129,0,118,1],[129,3]],"functionMap":{"names":["<global>","RotationGestureDetector","constructor","updateCurrent","finish","setKeyPointers","onTouchEvent","reset","get__anchorX","get__anchorY","get__rotation","get__timeDelta"],"mappings":"AAA;eCG;ECS;GDI;EEC;GF4B;EGC;GHO;EIC;GJO;EKC;GLsC;EMC;GNG;EOC;GPE;EQC;GRE;ESC;GTE;EUC;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}