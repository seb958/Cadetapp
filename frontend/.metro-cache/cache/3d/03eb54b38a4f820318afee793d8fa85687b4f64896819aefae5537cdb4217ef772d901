{"dependencies":[{"name":"../constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":50,"index":65}}],"key":"eTOOXVNPpMK2U8dOAmBWjbEJ4yE=","exportNames":["*"],"imports":1}},{"name":"../interfaces","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":66},"end":{"line":4,"column":43,"index":109}}],"key":"GMKh3a5g5xNaAog15vl07v6pG2U=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return ScaleGestureDetector;\n    }\n  });\n  var _constants = require(_dependencyMap[0], \"../constants\");\n  var _interfaces = require(_dependencyMap[1], \"../interfaces\");\n  class ScaleGestureDetector {\n    inProgress = false;\n    constructor(callbacks) {\n      this.onScaleBegin = callbacks.onScaleBegin;\n      this.onScale = callbacks.onScale;\n      this.onScaleEnd = callbacks.onScaleEnd;\n      this.spanSlop = _constants.DEFAULT_TOUCH_SLOP * 2;\n      this.minSpan = 0;\n    }\n    onTouchEvent(event, tracker) {\n      this.currentTime = event.time;\n      const action = event.eventType;\n      const numOfPointers = tracker.trackedPointersCount;\n      const streamComplete = action === _interfaces.EventTypes.UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.CANCEL;\n      if (action === _interfaces.EventTypes.DOWN || streamComplete) {\n        if (this.inProgress) {\n          this.onScaleEnd(this);\n          this.inProgress = false;\n          this.initialSpan = 0;\n        }\n        if (streamComplete) {\n          return true;\n        }\n      }\n      const configChanged = action === _interfaces.EventTypes.DOWN || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_DOWN;\n      const pointerUp = action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP;\n      const ignoredPointer = pointerUp ? event.pointerId : undefined;\n\n      // Determine focal point\n\n      const div = pointerUp ? numOfPointers - 1 : numOfPointers;\n      const coordsSum = tracker.getAbsoluteCoordsSum();\n      const focusX = coordsSum.x / div;\n      const focusY = coordsSum.y / div;\n\n      // Determine average deviation from focal point\n\n      let devSumX = 0;\n      let devSumY = 0;\n      tracker.trackedPointers.forEach((value, key) => {\n        if (key === ignoredPointer) {\n          return;\n        }\n        devSumX += Math.abs(value.abosoluteCoords.x - focusX);\n        devSumY += Math.abs(value.abosoluteCoords.y - focusY);\n      });\n      const devX = devSumX / div;\n      const devY = devSumY / div;\n      const spanX = devX * 2;\n      const spanY = devY * 2;\n      const span = Math.hypot(spanX, spanY);\n\n      // Begin/end events\n      const wasInProgress = this.inProgress;\n      this._focusX = focusX;\n      this._focusY = focusY;\n      if (this.inProgress && (span < this.minSpan || configChanged)) {\n        this.onScaleEnd(this);\n        this.inProgress = false;\n        this.initialSpan = span;\n      }\n      if (configChanged) {\n        this.initialSpan = this.prevSpan = this._currentSpan = span;\n      }\n      if (!this.inProgress && span >= this.minSpan && (wasInProgress || Math.abs(span - this.initialSpan) > this.spanSlop)) {\n        this.prevSpan = this._currentSpan = span;\n        this.prevTime = this.currentTime;\n        this.inProgress = this.onScaleBegin(this);\n      }\n\n      // Handle motion\n      if (action !== _interfaces.EventTypes.MOVE) {\n        return true;\n      }\n      this._currentSpan = span;\n      if (this.inProgress && !this.onScale(this)) {\n        return true;\n      }\n      this.prevSpan = this.currentSpan;\n      this.prevTime = this.currentTime;\n      return true;\n    }\n    calculateScaleFactor(numOfPointers) {\n      if (numOfPointers < 2) {\n        return 1;\n      }\n      return this.prevSpan > 0 ? this.currentSpan / this.prevSpan : 1;\n    }\n    get currentSpan() {\n      return this._currentSpan;\n    }\n    get focusX() {\n      return this._focusX;\n    }\n    get focusY() {\n      return this._focusY;\n    }\n    get timeDelta() {\n      return this.currentTime - this.prevTime;\n    }\n  }\n});","lineCount":116,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,5,15,"Object"],[7,8,5,15],[7,9,5,15,"defineProperty"],[7,23,5,15],[7,24,5,15,"exports"],[7,31,5,15],[8,4,5,15,"enumerable"],[8,14,5,15],[9,4,5,15,"get"],[9,7,5,15],[9,18,5,15,"get"],[9,19,5,15],[10,6,5,15],[10,13,5,15,"ScaleGestureDetector"],[10,33,5,15],[11,4,5,15],[12,2,5,15],[13,2,3,0],[13,6,3,0,"_constants"],[13,16,3,0],[13,19,3,0,"require"],[13,26,3,0],[13,27,3,0,"_dependencyMap"],[13,41,3,0],[14,2,4,0],[14,6,4,0,"_interfaces"],[14,17,4,0],[14,20,4,0,"require"],[14,27,4,0],[14,28,4,0,"_dependencyMap"],[14,42,4,0],[15,2,5,15],[15,8,5,21,"ScaleGestureDetector"],[15,28,5,41],[15,29,5,42],[16,4,6,2,"inProgress"],[16,14,6,12],[16,17,6,15],[16,22,6,20],[17,4,7,2,"constructor"],[17,15,7,13,"constructor"],[17,16,7,14,"callbacks"],[17,25,7,23],[17,27,7,25],[18,6,8,4],[18,10,8,8],[18,11,8,9,"onScaleBegin"],[18,23,8,21],[18,26,8,24,"callbacks"],[18,35,8,33],[18,36,8,34,"onScaleBegin"],[18,48,8,46],[19,6,9,4],[19,10,9,8],[19,11,9,9,"onScale"],[19,18,9,16],[19,21,9,19,"callbacks"],[19,30,9,28],[19,31,9,29,"onScale"],[19,38,9,36],[20,6,10,4],[20,10,10,8],[20,11,10,9,"onScaleEnd"],[20,21,10,19],[20,24,10,22,"callbacks"],[20,33,10,31],[20,34,10,32,"onScaleEnd"],[20,44,10,42],[21,6,11,4],[21,10,11,8],[21,11,11,9,"spanSlop"],[21,19,11,17],[21,22,11,20,"DEFAULT_TOUCH_SLOP"],[21,32,11,38],[21,33,11,38,"DEFAULT_TOUCH_SLOP"],[21,51,11,38],[21,54,11,41],[21,55,11,42],[22,6,12,4],[22,10,12,8],[22,11,12,9,"minSpan"],[22,18,12,16],[22,21,12,19],[22,22,12,20],[23,4,13,2],[24,4,14,2,"onTouchEvent"],[24,16,14,14,"onTouchEvent"],[24,17,14,15,"event"],[24,22,14,20],[24,24,14,22,"tracker"],[24,31,14,29],[24,33,14,31],[25,6,15,4],[25,10,15,8],[25,11,15,9,"currentTime"],[25,22,15,20],[25,25,15,23,"event"],[25,30,15,28],[25,31,15,29,"time"],[25,35,15,33],[26,6,16,4],[26,12,16,10,"action"],[26,18,16,16],[26,21,16,19,"event"],[26,26,16,24],[26,27,16,25,"eventType"],[26,36,16,34],[27,6,17,4],[27,12,17,10,"numOfPointers"],[27,25,17,23],[27,28,17,26,"tracker"],[27,35,17,33],[27,36,17,34,"trackedPointersCount"],[27,56,17,54],[28,6,18,4],[28,12,18,10,"streamComplete"],[28,26,18,24],[28,29,18,27,"action"],[28,35,18,33],[28,40,18,38,"EventTypes"],[28,51,18,48],[28,52,18,48,"EventTypes"],[28,62,18,48],[28,63,18,49,"UP"],[28,65,18,51],[28,69,18,55,"action"],[28,75,18,61],[28,80,18,66,"EventTypes"],[28,91,18,76],[28,92,18,76,"EventTypes"],[28,102,18,76],[28,103,18,77,"ADDITIONAL_POINTER_UP"],[28,124,18,98],[28,128,18,102,"action"],[28,134,18,108],[28,139,18,113,"EventTypes"],[28,150,18,123],[28,151,18,123,"EventTypes"],[28,161,18,123],[28,162,18,124,"CANCEL"],[28,168,18,130],[29,6,19,4],[29,10,19,8,"action"],[29,16,19,14],[29,21,19,19,"EventTypes"],[29,32,19,29],[29,33,19,29,"EventTypes"],[29,43,19,29],[29,44,19,30,"DOWN"],[29,48,19,34],[29,52,19,38,"streamComplete"],[29,66,19,52],[29,68,19,54],[30,8,20,6],[30,12,20,10],[30,16,20,14],[30,17,20,15,"inProgress"],[30,27,20,25],[30,29,20,27],[31,10,21,8],[31,14,21,12],[31,15,21,13,"onScaleEnd"],[31,25,21,23],[31,26,21,24],[31,30,21,28],[31,31,21,29],[32,10,22,8],[32,14,22,12],[32,15,22,13,"inProgress"],[32,25,22,23],[32,28,22,26],[32,33,22,31],[33,10,23,8],[33,14,23,12],[33,15,23,13,"initialSpan"],[33,26,23,24],[33,29,23,27],[33,30,23,28],[34,8,24,6],[35,8,25,6],[35,12,25,10,"streamComplete"],[35,26,25,24],[35,28,25,26],[36,10,26,8],[36,17,26,15],[36,21,26,19],[37,8,27,6],[38,6,28,4],[39,6,29,4],[39,12,29,10,"configChanged"],[39,25,29,23],[39,28,29,26,"action"],[39,34,29,32],[39,39,29,37,"EventTypes"],[39,50,29,47],[39,51,29,47,"EventTypes"],[39,61,29,47],[39,62,29,48,"DOWN"],[39,66,29,52],[39,70,29,56,"action"],[39,76,29,62],[39,81,29,67,"EventTypes"],[39,92,29,77],[39,93,29,77,"EventTypes"],[39,103,29,77],[39,104,29,78,"ADDITIONAL_POINTER_UP"],[39,125,29,99],[39,129,29,103,"action"],[39,135,29,109],[39,140,29,114,"EventTypes"],[39,151,29,124],[39,152,29,124,"EventTypes"],[39,162,29,124],[39,163,29,125,"ADDITIONAL_POINTER_DOWN"],[39,186,29,148],[40,6,30,4],[40,12,30,10,"pointerUp"],[40,21,30,19],[40,24,30,22,"action"],[40,30,30,28],[40,35,30,33,"EventTypes"],[40,46,30,43],[40,47,30,43,"EventTypes"],[40,57,30,43],[40,58,30,44,"ADDITIONAL_POINTER_UP"],[40,79,30,65],[41,6,31,4],[41,12,31,10,"ignoredPointer"],[41,26,31,24],[41,29,31,27,"pointerUp"],[41,38,31,36],[41,41,31,39,"event"],[41,46,31,44],[41,47,31,45,"pointerId"],[41,56,31,54],[41,59,31,57,"undefined"],[41,68,31,66],[43,6,33,4],[45,6,35,4],[45,12,35,10,"div"],[45,15,35,13],[45,18,35,16,"pointerUp"],[45,27,35,25],[45,30,35,28,"numOfPointers"],[45,43,35,41],[45,46,35,44],[45,47,35,45],[45,50,35,48,"numOfPointers"],[45,63,35,61],[46,6,36,4],[46,12,36,10,"coordsSum"],[46,21,36,19],[46,24,36,22,"tracker"],[46,31,36,29],[46,32,36,30,"getAbsoluteCoordsSum"],[46,52,36,50],[46,53,36,51],[46,54,36,52],[47,6,37,4],[47,12,37,10,"focusX"],[47,18,37,16],[47,21,37,19,"coordsSum"],[47,30,37,28],[47,31,37,29,"x"],[47,32,37,30],[47,35,37,33,"div"],[47,38,37,36],[48,6,38,4],[48,12,38,10,"focusY"],[48,18,38,16],[48,21,38,19,"coordsSum"],[48,30,38,28],[48,31,38,29,"y"],[48,32,38,30],[48,35,38,33,"div"],[48,38,38,36],[50,6,40,4],[52,6,42,4],[52,10,42,8,"devSumX"],[52,17,42,15],[52,20,42,18],[52,21,42,19],[53,6,43,4],[53,10,43,8,"devSumY"],[53,17,43,15],[53,20,43,18],[53,21,43,19],[54,6,44,4,"tracker"],[54,13,44,11],[54,14,44,12,"trackedPointers"],[54,29,44,27],[54,30,44,28,"forEach"],[54,37,44,35],[54,38,44,36],[54,39,44,37,"value"],[54,44,44,42],[54,46,44,44,"key"],[54,49,44,47],[54,54,44,52],[55,8,45,6],[55,12,45,10,"key"],[55,15,45,13],[55,20,45,18,"ignoredPointer"],[55,34,45,32],[55,36,45,34],[56,10,46,8],[57,8,47,6],[58,8,48,6,"devSumX"],[58,15,48,13],[58,19,48,17,"Math"],[58,23,48,21],[58,24,48,22,"abs"],[58,27,48,25],[58,28,48,26,"value"],[58,33,48,31],[58,34,48,32,"abosoluteCoords"],[58,49,48,47],[58,50,48,48,"x"],[58,51,48,49],[58,54,48,52,"focusX"],[58,60,48,58],[58,61,48,59],[59,8,49,6,"devSumY"],[59,15,49,13],[59,19,49,17,"Math"],[59,23,49,21],[59,24,49,22,"abs"],[59,27,49,25],[59,28,49,26,"value"],[59,33,49,31],[59,34,49,32,"abosoluteCoords"],[59,49,49,47],[59,50,49,48,"y"],[59,51,49,49],[59,54,49,52,"focusY"],[59,60,49,58],[59,61,49,59],[60,6,50,4],[60,7,50,5],[60,8,50,6],[61,6,51,4],[61,12,51,10,"devX"],[61,16,51,14],[61,19,51,17,"devSumX"],[61,26,51,24],[61,29,51,27,"div"],[61,32,51,30],[62,6,52,4],[62,12,52,10,"devY"],[62,16,52,14],[62,19,52,17,"devSumY"],[62,26,52,24],[62,29,52,27,"div"],[62,32,52,30],[63,6,53,4],[63,12,53,10,"spanX"],[63,17,53,15],[63,20,53,18,"devX"],[63,24,53,22],[63,27,53,25],[63,28,53,26],[64,6,54,4],[64,12,54,10,"spanY"],[64,17,54,15],[64,20,54,18,"devY"],[64,24,54,22],[64,27,54,25],[64,28,54,26],[65,6,55,4],[65,12,55,10,"span"],[65,16,55,14],[65,19,55,17,"Math"],[65,23,55,21],[65,24,55,22,"hypot"],[65,29,55,27],[65,30,55,28,"spanX"],[65,35,55,33],[65,37,55,35,"spanY"],[65,42,55,40],[65,43,55,41],[67,6,57,4],[68,6,58,4],[68,12,58,10,"wasInProgress"],[68,25,58,23],[68,28,58,26],[68,32,58,30],[68,33,58,31,"inProgress"],[68,43,58,41],[69,6,59,4],[69,10,59,8],[69,11,59,9,"_focusX"],[69,18,59,16],[69,21,59,19,"focusX"],[69,27,59,25],[70,6,60,4],[70,10,60,8],[70,11,60,9,"_focusY"],[70,18,60,16],[70,21,60,19,"focusY"],[70,27,60,25],[71,6,61,4],[71,10,61,8],[71,14,61,12],[71,15,61,13,"inProgress"],[71,25,61,23],[71,30,61,28,"span"],[71,34,61,32],[71,37,61,35],[71,41,61,39],[71,42,61,40,"minSpan"],[71,49,61,47],[71,53,61,51,"configChanged"],[71,66,61,64],[71,67,61,65],[71,69,61,67],[72,8,62,6],[72,12,62,10],[72,13,62,11,"onScaleEnd"],[72,23,62,21],[72,24,62,22],[72,28,62,26],[72,29,62,27],[73,8,63,6],[73,12,63,10],[73,13,63,11,"inProgress"],[73,23,63,21],[73,26,63,24],[73,31,63,29],[74,8,64,6],[74,12,64,10],[74,13,64,11,"initialSpan"],[74,24,64,22],[74,27,64,25,"span"],[74,31,64,29],[75,6,65,4],[76,6,66,4],[76,10,66,8,"configChanged"],[76,23,66,21],[76,25,66,23],[77,8,67,6],[77,12,67,10],[77,13,67,11,"initialSpan"],[77,24,67,22],[77,27,67,25],[77,31,67,29],[77,32,67,30,"prevSpan"],[77,40,67,38],[77,43,67,41],[77,47,67,45],[77,48,67,46,"_currentSpan"],[77,60,67,58],[77,63,67,61,"span"],[77,67,67,65],[78,6,68,4],[79,6,69,4],[79,10,69,8],[79,11,69,9],[79,15,69,13],[79,16,69,14,"inProgress"],[79,26,69,24],[79,30,69,28,"span"],[79,34,69,32],[79,38,69,36],[79,42,69,40],[79,43,69,41,"minSpan"],[79,50,69,48],[79,55,69,53,"wasInProgress"],[79,68,69,66],[79,72,69,70,"Math"],[79,76,69,74],[79,77,69,75,"abs"],[79,80,69,78],[79,81,69,79,"span"],[79,85,69,83],[79,88,69,86],[79,92,69,90],[79,93,69,91,"initialSpan"],[79,104,69,102],[79,105,69,103],[79,108,69,106],[79,112,69,110],[79,113,69,111,"spanSlop"],[79,121,69,119],[79,122,69,120],[79,124,69,122],[80,8,70,6],[80,12,70,10],[80,13,70,11,"prevSpan"],[80,21,70,19],[80,24,70,22],[80,28,70,26],[80,29,70,27,"_currentSpan"],[80,41,70,39],[80,44,70,42,"span"],[80,48,70,46],[81,8,71,6],[81,12,71,10],[81,13,71,11,"prevTime"],[81,21,71,19],[81,24,71,22],[81,28,71,26],[81,29,71,27,"currentTime"],[81,40,71,38],[82,8,72,6],[82,12,72,10],[82,13,72,11,"inProgress"],[82,23,72,21],[82,26,72,24],[82,30,72,28],[82,31,72,29,"onScaleBegin"],[82,43,72,41],[82,44,72,42],[82,48,72,46],[82,49,72,47],[83,6,73,4],[85,6,75,4],[86,6,76,4],[86,10,76,8,"action"],[86,16,76,14],[86,21,76,19,"EventTypes"],[86,32,76,29],[86,33,76,29,"EventTypes"],[86,43,76,29],[86,44,76,30,"MOVE"],[86,48,76,34],[86,50,76,36],[87,8,77,6],[87,15,77,13],[87,19,77,17],[88,6,78,4],[89,6,79,4],[89,10,79,8],[89,11,79,9,"_currentSpan"],[89,23,79,21],[89,26,79,24,"span"],[89,30,79,28],[90,6,80,4],[90,10,80,8],[90,14,80,12],[90,15,80,13,"inProgress"],[90,25,80,23],[90,29,80,27],[90,30,80,28],[90,34,80,32],[90,35,80,33,"onScale"],[90,42,80,40],[90,43,80,41],[90,47,80,45],[90,48,80,46],[90,50,80,48],[91,8,81,6],[91,15,81,13],[91,19,81,17],[92,6,82,4],[93,6,83,4],[93,10,83,8],[93,11,83,9,"prevSpan"],[93,19,83,17],[93,22,83,20],[93,26,83,24],[93,27,83,25,"currentSpan"],[93,38,83,36],[94,6,84,4],[94,10,84,8],[94,11,84,9,"prevTime"],[94,19,84,17],[94,22,84,20],[94,26,84,24],[94,27,84,25,"currentTime"],[94,38,84,36],[95,6,85,4],[95,13,85,11],[95,17,85,15],[96,4,86,2],[97,4,87,2,"calculateScaleFactor"],[97,24,87,22,"calculateScaleFactor"],[97,25,87,23,"numOfPointers"],[97,38,87,36],[97,40,87,38],[98,6,88,4],[98,10,88,8,"numOfPointers"],[98,23,88,21],[98,26,88,24],[98,27,88,25],[98,29,88,27],[99,8,89,6],[99,15,89,13],[99,16,89,14],[100,6,90,4],[101,6,91,4],[101,13,91,11],[101,17,91,15],[101,18,91,16,"prevSpan"],[101,26,91,24],[101,29,91,27],[101,30,91,28],[101,33,91,31],[101,37,91,35],[101,38,91,36,"currentSpan"],[101,49,91,47],[101,52,91,50],[101,56,91,54],[101,57,91,55,"prevSpan"],[101,65,91,63],[101,68,91,66],[101,69,91,67],[102,4,92,2],[103,4,93,2],[103,8,93,6,"currentSpan"],[103,19,93,17,"currentSpan"],[103,20,93,17],[103,22,93,20],[104,6,94,4],[104,13,94,11],[104,17,94,15],[104,18,94,16,"_currentSpan"],[104,30,94,28],[105,4,95,2],[106,4,96,2],[106,8,96,6,"focusX"],[106,14,96,12,"focusX"],[106,15,96,12],[106,17,96,15],[107,6,97,4],[107,13,97,11],[107,17,97,15],[107,18,97,16,"_focusX"],[107,25,97,23],[108,4,98,2],[109,4,99,2],[109,8,99,6,"focusY"],[109,14,99,12,"focusY"],[109,15,99,12],[109,17,99,15],[110,6,100,4],[110,13,100,11],[110,17,100,15],[110,18,100,16,"_focusY"],[110,25,100,23],[111,4,101,2],[112,4,102,2],[112,8,102,6,"timeDelta"],[112,17,102,15,"timeDelta"],[112,18,102,15],[112,20,102,18],[113,6,103,4],[113,13,103,11],[113,17,103,15],[113,18,103,16,"currentTime"],[113,29,103,27],[113,32,103,30],[113,36,103,34],[113,37,103,35,"prevTime"],[113,45,103,43],[114,4,104,2],[115,2,105,0],[116,0,105,1],[116,3]],"functionMap":{"names":["<global>","ScaleGestureDetector","constructor","onTouchEvent","tracker.trackedPointers.forEach$argument_0","calculateScaleFactor","get__currentSpan","get__focusX","get__focusY","get__timeDelta"],"mappings":"AAA;eCI;ECE;GDM;EEC;oCC8B;KDM;GFoC;EIC;GJK;EKC;GLE;EMC;GNE;EOC;GPE;EQC;GRE;CDC"},"hasCjsExports":false},"type":"js/module"}]}