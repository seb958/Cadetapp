{"dependencies":[{"name":"../constants","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":17,"index":123},"end":{"line":7,"column":40,"index":146}}],"key":"zmjjtqoQxi2W71eIMIIaEi1mOpU=","exportNames":["*"],"imports":1}},{"name":"../interfaces","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":18,"index":166},"end":{"line":8,"column":42,"index":190}}],"key":"596k1m46J08d+Af0Max0usWU1VI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _constants = require(_dependencyMap[0], \"../constants\");\n  var _interfaces = require(_dependencyMap[1], \"../interfaces\");\n  class ScaleGestureDetector {\n    inProgress = false;\n    constructor(callbacks) {\n      this.onScaleBegin = callbacks.onScaleBegin;\n      this.onScale = callbacks.onScale;\n      this.onScaleEnd = callbacks.onScaleEnd;\n      this.spanSlop = _constants.DEFAULT_TOUCH_SLOP * 2;\n      this.minSpan = 0;\n    }\n    onTouchEvent(event, tracker) {\n      this.currentTime = event.time;\n      const action = event.eventType;\n      const numOfPointers = tracker.trackedPointersCount;\n      const streamComplete = action === _interfaces.EventTypes.UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.CANCEL;\n      if (action === _interfaces.EventTypes.DOWN || streamComplete) {\n        if (this.inProgress) {\n          this.onScaleEnd(this);\n          this.inProgress = false;\n          this.initialSpan = 0;\n        }\n        if (streamComplete) {\n          return true;\n        }\n      }\n      const configChanged = action === _interfaces.EventTypes.DOWN || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_DOWN;\n      const pointerUp = action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP;\n      const ignoredPointer = pointerUp ? event.pointerId : undefined;\n\n      // Determine focal point\n\n      const div = pointerUp ? numOfPointers - 1 : numOfPointers;\n      const coordsSum = tracker.getAbsoluteCoordsSum();\n      const focusX = coordsSum.x / div;\n      const focusY = coordsSum.y / div;\n\n      // Determine average deviation from focal point\n\n      let devSumX = 0;\n      let devSumY = 0;\n      tracker.trackedPointers.forEach((value, key) => {\n        if (key === ignoredPointer) {\n          return;\n        }\n        devSumX += Math.abs(value.abosoluteCoords.x - focusX);\n        devSumY += Math.abs(value.abosoluteCoords.y - focusY);\n      });\n      const devX = devSumX / div;\n      const devY = devSumY / div;\n      const spanX = devX * 2;\n      const spanY = devY * 2;\n      const span = Math.hypot(spanX, spanY);\n\n      // Begin/end events\n      const wasInProgress = this.inProgress;\n      this._focusX = focusX;\n      this._focusY = focusY;\n      if (this.inProgress && (span < this.minSpan || configChanged)) {\n        this.onScaleEnd(this);\n        this.inProgress = false;\n        this.initialSpan = span;\n      }\n      if (configChanged) {\n        this.initialSpan = this.prevSpan = this._currentSpan = span;\n      }\n      if (!this.inProgress && span >= this.minSpan && (wasInProgress || Math.abs(span - this.initialSpan) > this.spanSlop)) {\n        this.prevSpan = this._currentSpan = span;\n        this.prevTime = this.currentTime;\n        this.inProgress = this.onScaleBegin(this);\n      }\n\n      // Handle motion\n      if (action !== _interfaces.EventTypes.MOVE) {\n        return true;\n      }\n      this._currentSpan = span;\n      if (this.inProgress && !this.onScale(this)) {\n        return true;\n      }\n      this.prevSpan = this.currentSpan;\n      this.prevTime = this.currentTime;\n      return true;\n    }\n    calculateScaleFactor(numOfPointers) {\n      if (numOfPointers < 2) {\n        return 1;\n      }\n      return this.prevSpan > 0 ? this.currentSpan / this.prevSpan : 1;\n    }\n    get currentSpan() {\n      return this._currentSpan;\n    }\n    get focusX() {\n      return this._focusX;\n    }\n    get focusY() {\n      return this._focusY;\n    }\n    get timeDelta() {\n      return this.currentTime - this.prevTime;\n    }\n  }\n  exports.default = ScaleGestureDetector;\n});","lineCount":112,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,2,5,0],[6,3,5,1],[6,4,5,2],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"default"],[7,17,6,15],[7,20,6,18],[7,25,6,23],[7,26,6,24],[8,2,7,0],[8,6,7,4,"_constants"],[8,16,7,14],[8,19,7,17,"require"],[8,26,7,24],[8,27,7,24,"_dependencyMap"],[8,41,7,24],[8,60,7,39],[8,61,7,40],[9,2,8,0],[9,6,8,4,"_interfaces"],[9,17,8,15],[9,20,8,18,"require"],[9,27,8,25],[9,28,8,25,"_dependencyMap"],[9,42,8,25],[9,62,8,41],[9,63,8,42],[10,2,9,0],[10,8,9,6,"ScaleGestureDetector"],[10,28,9,26],[10,29,9,27],[11,4,10,2,"inProgress"],[11,14,10,12],[11,17,10,15],[11,22,10,20],[12,4,11,2,"constructor"],[12,15,11,13,"constructor"],[12,16,11,14,"callbacks"],[12,25,11,23],[12,27,11,25],[13,6,12,4],[13,10,12,8],[13,11,12,9,"onScaleBegin"],[13,23,12,21],[13,26,12,24,"callbacks"],[13,35,12,33],[13,36,12,34,"onScaleBegin"],[13,48,12,46],[14,6,13,4],[14,10,13,8],[14,11,13,9,"onScale"],[14,18,13,16],[14,21,13,19,"callbacks"],[14,30,13,28],[14,31,13,29,"onScale"],[14,38,13,36],[15,6,14,4],[15,10,14,8],[15,11,14,9,"onScaleEnd"],[15,21,14,19],[15,24,14,22,"callbacks"],[15,33,14,31],[15,34,14,32,"onScaleEnd"],[15,44,14,42],[16,6,15,4],[16,10,15,8],[16,11,15,9,"spanSlop"],[16,19,15,17],[16,22,15,20,"_constants"],[16,32,15,30],[16,33,15,31,"DEFAULT_TOUCH_SLOP"],[16,51,15,49],[16,54,15,52],[16,55,15,53],[17,6,16,4],[17,10,16,8],[17,11,16,9,"minSpan"],[17,18,16,16],[17,21,16,19],[17,22,16,20],[18,4,17,2],[19,4,18,2,"onTouchEvent"],[19,16,18,14,"onTouchEvent"],[19,17,18,15,"event"],[19,22,18,20],[19,24,18,22,"tracker"],[19,31,18,29],[19,33,18,31],[20,6,19,4],[20,10,19,8],[20,11,19,9,"currentTime"],[20,22,19,20],[20,25,19,23,"event"],[20,30,19,28],[20,31,19,29,"time"],[20,35,19,33],[21,6,20,4],[21,12,20,10,"action"],[21,18,20,16],[21,21,20,19,"event"],[21,26,20,24],[21,27,20,25,"eventType"],[21,36,20,34],[22,6,21,4],[22,12,21,10,"numOfPointers"],[22,25,21,23],[22,28,21,26,"tracker"],[22,35,21,33],[22,36,21,34,"trackedPointersCount"],[22,56,21,54],[23,6,22,4],[23,12,22,10,"streamComplete"],[23,26,22,24],[23,29,22,27,"action"],[23,35,22,33],[23,40,22,38,"_interfaces"],[23,51,22,49],[23,52,22,50,"EventTypes"],[23,62,22,60],[23,63,22,61,"UP"],[23,65,22,63],[23,69,22,67,"action"],[23,75,22,73],[23,80,22,78,"_interfaces"],[23,91,22,89],[23,92,22,90,"EventTypes"],[23,102,22,100],[23,103,22,101,"ADDITIONAL_POINTER_UP"],[23,124,22,122],[23,128,22,126,"action"],[23,134,22,132],[23,139,22,137,"_interfaces"],[23,150,22,148],[23,151,22,149,"EventTypes"],[23,161,22,159],[23,162,22,160,"CANCEL"],[23,168,22,166],[24,6,23,4],[24,10,23,8,"action"],[24,16,23,14],[24,21,23,19,"_interfaces"],[24,32,23,30],[24,33,23,31,"EventTypes"],[24,43,23,41],[24,44,23,42,"DOWN"],[24,48,23,46],[24,52,23,50,"streamComplete"],[24,66,23,64],[24,68,23,66],[25,8,24,6],[25,12,24,10],[25,16,24,14],[25,17,24,15,"inProgress"],[25,27,24,25],[25,29,24,27],[26,10,25,8],[26,14,25,12],[26,15,25,13,"onScaleEnd"],[26,25,25,23],[26,26,25,24],[26,30,25,28],[26,31,25,29],[27,10,26,8],[27,14,26,12],[27,15,26,13,"inProgress"],[27,25,26,23],[27,28,26,26],[27,33,26,31],[28,10,27,8],[28,14,27,12],[28,15,27,13,"initialSpan"],[28,26,27,24],[28,29,27,27],[28,30,27,28],[29,8,28,6],[30,8,29,6],[30,12,29,10,"streamComplete"],[30,26,29,24],[30,28,29,26],[31,10,30,8],[31,17,30,15],[31,21,30,19],[32,8,31,6],[33,6,32,4],[34,6,33,4],[34,12,33,10,"configChanged"],[34,25,33,23],[34,28,33,26,"action"],[34,34,33,32],[34,39,33,37,"_interfaces"],[34,50,33,48],[34,51,33,49,"EventTypes"],[34,61,33,59],[34,62,33,60,"DOWN"],[34,66,33,64],[34,70,33,68,"action"],[34,76,33,74],[34,81,33,79,"_interfaces"],[34,92,33,90],[34,93,33,91,"EventTypes"],[34,103,33,101],[34,104,33,102,"ADDITIONAL_POINTER_UP"],[34,125,33,123],[34,129,33,127,"action"],[34,135,33,133],[34,140,33,138,"_interfaces"],[34,151,33,149],[34,152,33,150,"EventTypes"],[34,162,33,160],[34,163,33,161,"ADDITIONAL_POINTER_DOWN"],[34,186,33,184],[35,6,34,4],[35,12,34,10,"pointerUp"],[35,21,34,19],[35,24,34,22,"action"],[35,30,34,28],[35,35,34,33,"_interfaces"],[35,46,34,44],[35,47,34,45,"EventTypes"],[35,57,34,55],[35,58,34,56,"ADDITIONAL_POINTER_UP"],[35,79,34,77],[36,6,35,4],[36,12,35,10,"ignoredPointer"],[36,26,35,24],[36,29,35,27,"pointerUp"],[36,38,35,36],[36,41,35,39,"event"],[36,46,35,44],[36,47,35,45,"pointerId"],[36,56,35,54],[36,59,35,57,"undefined"],[36,68,35,66],[38,6,37,4],[40,6,39,4],[40,12,39,10,"div"],[40,15,39,13],[40,18,39,16,"pointerUp"],[40,27,39,25],[40,30,39,28,"numOfPointers"],[40,43,39,41],[40,46,39,44],[40,47,39,45],[40,50,39,48,"numOfPointers"],[40,63,39,61],[41,6,40,4],[41,12,40,10,"coordsSum"],[41,21,40,19],[41,24,40,22,"tracker"],[41,31,40,29],[41,32,40,30,"getAbsoluteCoordsSum"],[41,52,40,50],[41,53,40,51],[41,54,40,52],[42,6,41,4],[42,12,41,10,"focusX"],[42,18,41,16],[42,21,41,19,"coordsSum"],[42,30,41,28],[42,31,41,29,"x"],[42,32,41,30],[42,35,41,33,"div"],[42,38,41,36],[43,6,42,4],[43,12,42,10,"focusY"],[43,18,42,16],[43,21,42,19,"coordsSum"],[43,30,42,28],[43,31,42,29,"y"],[43,32,42,30],[43,35,42,33,"div"],[43,38,42,36],[45,6,44,4],[47,6,46,4],[47,10,46,8,"devSumX"],[47,17,46,15],[47,20,46,18],[47,21,46,19],[48,6,47,4],[48,10,47,8,"devSumY"],[48,17,47,15],[48,20,47,18],[48,21,47,19],[49,6,48,4,"tracker"],[49,13,48,11],[49,14,48,12,"trackedPointers"],[49,29,48,27],[49,30,48,28,"forEach"],[49,37,48,35],[49,38,48,36],[49,39,48,37,"value"],[49,44,48,42],[49,46,48,44,"key"],[49,49,48,47],[49,54,48,52],[50,8,49,6],[50,12,49,10,"key"],[50,15,49,13],[50,20,49,18,"ignoredPointer"],[50,34,49,32],[50,36,49,34],[51,10,50,8],[52,8,51,6],[53,8,52,6,"devSumX"],[53,15,52,13],[53,19,52,17,"Math"],[53,23,52,21],[53,24,52,22,"abs"],[53,27,52,25],[53,28,52,26,"value"],[53,33,52,31],[53,34,52,32,"abosoluteCoords"],[53,49,52,47],[53,50,52,48,"x"],[53,51,52,49],[53,54,52,52,"focusX"],[53,60,52,58],[53,61,52,59],[54,8,53,6,"devSumY"],[54,15,53,13],[54,19,53,17,"Math"],[54,23,53,21],[54,24,53,22,"abs"],[54,27,53,25],[54,28,53,26,"value"],[54,33,53,31],[54,34,53,32,"abosoluteCoords"],[54,49,53,47],[54,50,53,48,"y"],[54,51,53,49],[54,54,53,52,"focusY"],[54,60,53,58],[54,61,53,59],[55,6,54,4],[55,7,54,5],[55,8,54,6],[56,6,55,4],[56,12,55,10,"devX"],[56,16,55,14],[56,19,55,17,"devSumX"],[56,26,55,24],[56,29,55,27,"div"],[56,32,55,30],[57,6,56,4],[57,12,56,10,"devY"],[57,16,56,14],[57,19,56,17,"devSumY"],[57,26,56,24],[57,29,56,27,"div"],[57,32,56,30],[58,6,57,4],[58,12,57,10,"spanX"],[58,17,57,15],[58,20,57,18,"devX"],[58,24,57,22],[58,27,57,25],[58,28,57,26],[59,6,58,4],[59,12,58,10,"spanY"],[59,17,58,15],[59,20,58,18,"devY"],[59,24,58,22],[59,27,58,25],[59,28,58,26],[60,6,59,4],[60,12,59,10,"span"],[60,16,59,14],[60,19,59,17,"Math"],[60,23,59,21],[60,24,59,22,"hypot"],[60,29,59,27],[60,30,59,28,"spanX"],[60,35,59,33],[60,37,59,35,"spanY"],[60,42,59,40],[60,43,59,41],[62,6,61,4],[63,6,62,4],[63,12,62,10,"wasInProgress"],[63,25,62,23],[63,28,62,26],[63,32,62,30],[63,33,62,31,"inProgress"],[63,43,62,41],[64,6,63,4],[64,10,63,8],[64,11,63,9,"_focusX"],[64,18,63,16],[64,21,63,19,"focusX"],[64,27,63,25],[65,6,64,4],[65,10,64,8],[65,11,64,9,"_focusY"],[65,18,64,16],[65,21,64,19,"focusY"],[65,27,64,25],[66,6,65,4],[66,10,65,8],[66,14,65,12],[66,15,65,13,"inProgress"],[66,25,65,23],[66,30,65,28,"span"],[66,34,65,32],[66,37,65,35],[66,41,65,39],[66,42,65,40,"minSpan"],[66,49,65,47],[66,53,65,51,"configChanged"],[66,66,65,64],[66,67,65,65],[66,69,65,67],[67,8,66,6],[67,12,66,10],[67,13,66,11,"onScaleEnd"],[67,23,66,21],[67,24,66,22],[67,28,66,26],[67,29,66,27],[68,8,67,6],[68,12,67,10],[68,13,67,11,"inProgress"],[68,23,67,21],[68,26,67,24],[68,31,67,29],[69,8,68,6],[69,12,68,10],[69,13,68,11,"initialSpan"],[69,24,68,22],[69,27,68,25,"span"],[69,31,68,29],[70,6,69,4],[71,6,70,4],[71,10,70,8,"configChanged"],[71,23,70,21],[71,25,70,23],[72,8,71,6],[72,12,71,10],[72,13,71,11,"initialSpan"],[72,24,71,22],[72,27,71,25],[72,31,71,29],[72,32,71,30,"prevSpan"],[72,40,71,38],[72,43,71,41],[72,47,71,45],[72,48,71,46,"_currentSpan"],[72,60,71,58],[72,63,71,61,"span"],[72,67,71,65],[73,6,72,4],[74,6,73,4],[74,10,73,8],[74,11,73,9],[74,15,73,13],[74,16,73,14,"inProgress"],[74,26,73,24],[74,30,73,28,"span"],[74,34,73,32],[74,38,73,36],[74,42,73,40],[74,43,73,41,"minSpan"],[74,50,73,48],[74,55,73,53,"wasInProgress"],[74,68,73,66],[74,72,73,70,"Math"],[74,76,73,74],[74,77,73,75,"abs"],[74,80,73,78],[74,81,73,79,"span"],[74,85,73,83],[74,88,73,86],[74,92,73,90],[74,93,73,91,"initialSpan"],[74,104,73,102],[74,105,73,103],[74,108,73,106],[74,112,73,110],[74,113,73,111,"spanSlop"],[74,121,73,119],[74,122,73,120],[74,124,73,122],[75,8,74,6],[75,12,74,10],[75,13,74,11,"prevSpan"],[75,21,74,19],[75,24,74,22],[75,28,74,26],[75,29,74,27,"_currentSpan"],[75,41,74,39],[75,44,74,42,"span"],[75,48,74,46],[76,8,75,6],[76,12,75,10],[76,13,75,11,"prevTime"],[76,21,75,19],[76,24,75,22],[76,28,75,26],[76,29,75,27,"currentTime"],[76,40,75,38],[77,8,76,6],[77,12,76,10],[77,13,76,11,"inProgress"],[77,23,76,21],[77,26,76,24],[77,30,76,28],[77,31,76,29,"onScaleBegin"],[77,43,76,41],[77,44,76,42],[77,48,76,46],[77,49,76,47],[78,6,77,4],[80,6,79,4],[81,6,80,4],[81,10,80,8,"action"],[81,16,80,14],[81,21,80,19,"_interfaces"],[81,32,80,30],[81,33,80,31,"EventTypes"],[81,43,80,41],[81,44,80,42,"MOVE"],[81,48,80,46],[81,50,80,48],[82,8,81,6],[82,15,81,13],[82,19,81,17],[83,6,82,4],[84,6,83,4],[84,10,83,8],[84,11,83,9,"_currentSpan"],[84,23,83,21],[84,26,83,24,"span"],[84,30,83,28],[85,6,84,4],[85,10,84,8],[85,14,84,12],[85,15,84,13,"inProgress"],[85,25,84,23],[85,29,84,27],[85,30,84,28],[85,34,84,32],[85,35,84,33,"onScale"],[85,42,84,40],[85,43,84,41],[85,47,84,45],[85,48,84,46],[85,50,84,48],[86,8,85,6],[86,15,85,13],[86,19,85,17],[87,6,86,4],[88,6,87,4],[88,10,87,8],[88,11,87,9,"prevSpan"],[88,19,87,17],[88,22,87,20],[88,26,87,24],[88,27,87,25,"currentSpan"],[88,38,87,36],[89,6,88,4],[89,10,88,8],[89,11,88,9,"prevTime"],[89,19,88,17],[89,22,88,20],[89,26,88,24],[89,27,88,25,"currentTime"],[89,38,88,36],[90,6,89,4],[90,13,89,11],[90,17,89,15],[91,4,90,2],[92,4,91,2,"calculateScaleFactor"],[92,24,91,22,"calculateScaleFactor"],[92,25,91,23,"numOfPointers"],[92,38,91,36],[92,40,91,38],[93,6,92,4],[93,10,92,8,"numOfPointers"],[93,23,92,21],[93,26,92,24],[93,27,92,25],[93,29,92,27],[94,8,93,6],[94,15,93,13],[94,16,93,14],[95,6,94,4],[96,6,95,4],[96,13,95,11],[96,17,95,15],[96,18,95,16,"prevSpan"],[96,26,95,24],[96,29,95,27],[96,30,95,28],[96,33,95,31],[96,37,95,35],[96,38,95,36,"currentSpan"],[96,49,95,47],[96,52,95,50],[96,56,95,54],[96,57,95,55,"prevSpan"],[96,65,95,63],[96,68,95,66],[96,69,95,67],[97,4,96,2],[98,4,97,2],[98,8,97,6,"currentSpan"],[98,19,97,17,"currentSpan"],[98,20,97,17],[98,22,97,20],[99,6,98,4],[99,13,98,11],[99,17,98,15],[99,18,98,16,"_currentSpan"],[99,30,98,28],[100,4,99,2],[101,4,100,2],[101,8,100,6,"focusX"],[101,14,100,12,"focusX"],[101,15,100,12],[101,17,100,15],[102,6,101,4],[102,13,101,11],[102,17,101,15],[102,18,101,16,"_focusX"],[102,25,101,23],[103,4,102,2],[104,4,103,2],[104,8,103,6,"focusY"],[104,14,103,12,"focusY"],[104,15,103,12],[104,17,103,15],[105,6,104,4],[105,13,104,11],[105,17,104,15],[105,18,104,16,"_focusY"],[105,25,104,23],[106,4,105,2],[107,4,106,2],[107,8,106,6,"timeDelta"],[107,17,106,15,"timeDelta"],[107,18,106,15],[107,20,106,18],[108,6,107,4],[108,13,107,11],[108,17,107,15],[108,18,107,16,"currentTime"],[108,29,107,27],[108,32,107,30],[108,36,107,34],[108,37,107,35,"prevTime"],[108,45,107,43],[109,4,108,2],[110,2,109,0],[111,2,110,0,"exports"],[111,9,110,7],[111,10,110,8,"default"],[111,17,110,15],[111,20,110,18,"ScaleGestureDetector"],[111,40,110,38],[112,0,110,39],[112,3]],"functionMap":{"names":["<global>","ScaleGestureDetector","constructor","onTouchEvent","tracker.trackedPointers.forEach$argument_0","calculateScaleFactor","get__currentSpan","get__focusX","get__focusY","get__timeDelta"],"mappings":"AAA;ACQ;ECE;GDM;EEC;oCC8B;KDM;GFoC;EIC;GJK;EKC;GLE;EMC;GNE;EOC;GPE;EQC;GRE;CDC"},"hasCjsExports":true},"type":"js/module"}]}